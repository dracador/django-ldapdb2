services:
  openldap:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: django-ldapdb2-openldap
    ports:
      - '389:389'
      - '636:636'
    volumes:
      - './ldifs:/ldifs'
      - './schema/:/schema'
      - type: tmpfs
        target: /var/lib/ldap
    ulimits:
      nofile:
        soft: 1024
        hard: 1024
    command: /init-ldap.sh

  openldap-symas:
    build:
      context: .
      dockerfile: Dockerfile-symas
    container_name: django-ldapdb2-openldap-symas
    ports:
      - '51389:389'
      - '51636:636'
    volumes:
      - './ldifs:/ldifs'
      - './schema/:/schema'
      - type: tmpfs
        target: /var/lib/ldap
    ulimits:
      nofile:
        soft: 1024
        hard: 1024
    command: /init-ldap-symas.sh

  apache-ds:
    image: openmicroscopy/apacheds:latest
    container_name: django-ldapdb2-apache-ds
    ports:
      - '52389:10389'
      - '52636:10636'
